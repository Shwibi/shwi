(this["webpackJsonpunacademy-live"]=this["webpackJsonpunacademy-live"]||[]).push([[12],{Tx6k:function(e,t,a){"use strict";a.r(t);var o=a("lSNA"),s=a.n(o),i=a("q1tI"),r=a.n(i),n=a("/MKj"),l=a("gRhY"),c=a("ri1g"),p=a("vOnD"),d=a("J4zp"),h=a.n(d),u=a("8ezB"),m=a("jxKE"),g=p.d.div.withConfig({displayName:"TimePill__Wrapper",componentId:"sc-1nfpfof-0"})(["padding:"," ",";background-color:",";display:flex;justify-content:center;align-items:center;border-radius:",";"],u.c.SPACING_1B,u.c.SPACING_2B,(function(e){return e.time<=10?e.theme.RED:e.time<=15?e.theme.BG_DARK:e.theme.DIVIDER}),u.c.SPACING_2B),f=p.d.div.withConfig({displayName:"TimePill__Time",componentId:"sc-1nfpfof-1"})(["color:",";font-size:",";line-height:",";"],(function(e){return e.time<=15?e.theme.WHITE:e.theme.TEXT_PRIMARY}),u.d.SMALL,u.d.LINE_HEIGHT),b=p.d.div.withConfig({displayName:"TimePill__Bold",componentId:"sc-1nfpfof-2"})(["display:inline;font-weight:",";"],u.d.BOLD),E=r.a.memo((function(e){var t=e.time;return r.a.createElement(g,{time:t},r.a.createElement(f,{time:t},r.a.createElement(b,null,t)," ".concat(m.Tb.TIME_SEC)))})),P=a("0dbe"),_=p.d.div.withConfig({displayName:"PollHeader__Wrapper",componentId:"pv7a6y-0"})(["display:flex;align-items:center;flex-direction:row;"]),I=p.d.div.withConfig({displayName:"PollHeader__PollText",componentId:"pv7a6y-1"})(["font-weight:",";font-size:",";line-height:",";color:",";margin-right:",";"],u.d.BOLD,u.d.LARGE,u.d.LINE_HEIGHT_MAX,(function(e){return e.theme.TEXT_PRIMARY}),u.c.SPACING_4B),k=p.d.div.withConfig({displayName:"PollHeader__CloseButton",componentId:"pv7a6y-2"})(["width:24px;height:24px;display:flex;justify-content:center;align-items:center;margin-right:",";cursor:pointer;"],u.c.SPACING_4B),S=r.a.memo((function(e){var t=e.timeRemaining,a=e.closePoll,o=function(){a()};return r.a.createElement(_,null,r.a.createElement(k,{onClick:o},r.a.createElement(P.x,null)),r.a.createElement(I,null,m.Tb.POLL_HEADER),function(){if(t>0)return r.a.createElement(E,{time:t})}())})),C=a("FKhi"),R=a("KUUV");const w={rank1:a("mTP5"),rank2:a("lKtP"),rank3:a("r4g9")},O=p.d.div.withConfig({displayName:"PollResultCard__Wrapper",componentId:"ka45mv-0"})(["height:88px;width:100%;position:absolute;left:0;display:flex;flex-direction:row;align-items:center;top:",";transition:top 0.4s ease-in-out;"],e=>e.exit?"-88px":e.enter?"0px":"88px"),v=p.d.div.withConfig({displayName:"PollResultCard__AvatarWrapper",componentId:"ka45mv-1"})(["position:relative;height:40px;width:40px;"]),T=p.d.img.withConfig({displayName:"PollResultCard__Badge",componentId:"ka45mv-2"})(["position:absolute;height:24px;bottom:0px;right:-4px;object-fit:cover;"]),y=p.d.div.withConfig({displayName:"PollResultCard__TextContainer",componentId:"ka45mv-3"})(["flex:1;margin-left:",";position:relative;height:100%;"],u.c.SPACING_4B),L=p.d.div.withConfig({displayName:"PollResultCard__TextWrapper",componentId:"ka45mv-4"})(["position:absolute;height:100%;width:100%;left:0;top:",";transition:top 0.4s;font-weight:",";font-size:",";line-height:",";color:",";text-align:left;display:flex;align-items:center;white-space:pre-wrap;"],e=>e.show?"0px":e.subText?"88px":"-88px",u.d.BOLD,u.d.MEDIUM,u.d.LINE_HEIGHT_MAX,({theme:e})=>e.TEXT_PRIMARY),A=p.d.div.withConfig({displayName:"PollResultCard__Name",componentId:"ka45mv-5"})(["color:",";text-transform:capitalize;display:inline;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:150px;"],({theme:e})=>e.BLUE),x=p.d.div.withConfig({displayName:"PollResultCard__Time",componentId:"ka45mv-6"})(["color:",";display:inline;"],e=>e.self?e.theme.GREEN:e.theme.ORANGE),M=p.d.div.withConfig({displayName:"PollResultCard__RedText",componentId:"ka45mv-7"})(["color:",";display:inline;"],({theme:e})=>e.RED);var N=({pollResult:e,show:t,onAnimationDone:a,shouldExit:o,index:s,correctAnswer:n})=>{e.uid;const l=e.name,c=e.avatar,p=e.timeTaken,d=e.self,u=e.didAttempt,g=e.rank,f=e.isCorrect,b=Object(i.useState)(!1),E=h()(b,2),P=E[0],_=E[1],I=Object(i.useState)(!1),k=h()(I,2),S=k[0],C=k[1],N=g>0&&g<=3,B=Object(i.useRef)(null),j=Object(i.useRef)(null);Object(i.useEffect)(()=>()=>{B.current&&clearTimeout(B.current),j.current&&clearTimeout(j)},[]),Object(i.useEffect)(()=>{let e=D()?2:1;return t&&(B.current=setTimeout(()=>{a(s),o&&_(!0)},1e3*e),D()&&(j.current=setTimeout(()=>{C(!0)},600))),()=>{clearTimeout(B),clearTimeout(j)}},[t,a]);const D=()=>d&&g>0,G=()=>r.a.createElement(L,{show:!S},r.a.createElement(A,null,"".concat(d?"You":l," ")),m.Tb.GOT_IT_RIGHT_IN,r.a.createElement(x,{self:d}," ".concat(p," sec"))),U=()=>d?N?G():u?f?G():r.a.createElement(L,{show:!S},m.Tb.OOOPS,n,m.Tb.IS_CORRECT_ANSWER):r.a.createElement(L,{show:!S},m.Tb.YOU,r.a.createElement(M,null,m.Tb.MISSED),m.Tb.THIS_ONE):G(),z=()=>{if(D())return N?r.a.createElement(L,{show:S,subText:!0},m.Tb.MADE_IN_TOP_3):r.a.createElement(L,{show:S,subText:!0},m.Tb.RANK_SUB_TEXT,g)};return r.a.createElement(O,{enter:t,exit:P},r.a.createElement(v,null,r.a.createElement(R.a,{size:40,avatar:c,borderSize:1}),(()=>{if(N){const e=w["rank".concat(g)];return r.a.createElement(T,{src:e})}})()),r.a.createElement(y,null,U(),z()))};const B=p.d.div.withConfig({displayName:"PollResultView__Wrapper",componentId:"sc-787vgj-0"})(["position:absolute;height:88px;width:350px;right:0px;overflow:hidden;"]);var j=r.a.memo(({leaderBoard:e,onAnimationDone:t,correctAnswer:a})=>{const o=Object(i.useState)(-1),s=h()(o,2),n=s[0],l=s[1];Object(i.useEffect)(()=>{let t;return e.size>0?t=setTimeout(()=>{l(0)},100):clearTimeout(t),()=>clearTimeout(t)},[e]);const c=Object(i.useCallback)(a=>{a==e.size-1&&t(),l(a+1)},[e]);return r.a.createElement(B,null,e.map((t,o)=>r.a.createElement(N,{key:o,index:o,pollResult:t,show:o<=n,onAnimationDone:c,shouldExit:o<e.size-1,correctAnswer:a})))}),D=a("g60p"),G=a("wCkA"),U=a("C7CA"),z=p.d.div.withConfig({displayName:"LearnerPoll__Wrapper",componentId:"sc-8obaln-0"})(["display:flex;height:100%;width:100%;align-items:center;flex-direction:row;justify-content:space-between;"]),H=p.d.div.withConfig({displayName:"LearnerPoll__ChoicesWrapper",componentId:"sc-8obaln-1"})(["display:flex;flex-direction:row;justify-content:flex-end;align-items:center;transition:transform 0.4s ease-in-out;max-width:480px;height:48px;flex:1;margin-left:",";> *{margin-right:",";}> *:last-child{margin-right:",";}transform:",";"],u.c.SPACING_4B,u.c.SPACING_2B,u.c.SPACING_0B,(function(e){return e.hide?"translateY(88px)":"unset"})),W=r.a.memo((function(e){var t=e.socketManager,a=Object(n.e)((function(e){return e.getIn(["poll","poll"])})),o=Object(n.e)((function(e){return e.getIn(["poll","isPollActive"])})),s=Object(n.e)((function(e){return e.getIn(["app","isReplay"])})),c=Object(n.e)((function(e){return e.getIn(["app","userId"])})),p=Object(D.a)(a.timeRemaining,0),d=Object(i.useState)(a.canChoose),u=h()(d,2),m=u[0],g=u[1],f=Object(i.useState)(a.selectedChoiceId),b=h()(f,2),E=b[0],P=b[1],_=Object(i.useState)(!1),I=h()(_,2),k=I[0],R=I[1],w=Object(U.a)(),O=Object(n.d)();Object(i.useEffect)((function(){return document.addEventListener("keydown",v),function(){document.removeEventListener("keydown",v)}}),[m,w]);var v=function(e){if(!e.ctrlKey&&!e.metaKey&&!w&&m)switch(e.key){case"a":case"b":case"c":case"d":case"e":case"A":case"B":case"C":case"D":case"E":y(e)}},T=function(e){var t=null;if(5===a.choices.size||4===a.choices.size?t=a.choices.find((function(t){return t.answer===e.toUpperCase()})):2===a.choices.size&&("a"===e&&"True"===a.choices.get(0).answer?t=a.choices.get(0):"b"===e&&(t=a.choices.get(1))),Object(G.vb)(t))return t.id},y=function(e){Object(G.vb)(T(e.key))&&A(T(e.key))};Object(i.useEffect)((function(){var e;return m||!o||s||(e=setInterval((function(){L()}),2e3)),function(){return clearInterval(e)}}),[m,o,s]),Object(i.useEffect)((function(){a.leaderBoard.size>0&&R(!0)}),[a.leaderBoard]);var L=function(){t.getPoll(a.id)},A=Object(i.useCallback)((function(e){s?a.replayId&&(Object(G.Jb)(a.replayId),Object(G.Gb)("Poll Responded",{"Property Type":"Respond Poll","User Id":c,replay:!0})):a.id&&t&&t.replyPoll(a.id,e),g(!1),P(e)}),[a,s,t]),x=Object(i.useCallback)((function(){O(Object(l.c)())}),[]),M=Object(i.useCallback)((function(){x()}),[]);return r.a.createElement(z,null,r.a.createElement(S,{timeRemaining:p,totalTime:a.totalTime,closePoll:x}),r.a.createElement(j,{leaderBoard:a.leaderBoard,onAnimationDone:M,correctAnswer:a.correctAnswer}),r.a.createElement(H,{hide:k},function(){var e=a.choices.size<=2?182:87;return a.choices.map((function(t,a){return r.a.createElement(C.a,{key:a,choice:t,onSelect:A,canChoose:m,isSelected:t.id==E,maxWidth:e,hasShadow:!0})}))}()))})),F=a("9/5/"),K=a.n(F),Y=a("RYsq");const J=p.d.div.withConfig({displayName:"Poll__Wrapper",componentId:"rjwlsa-0"})(["position:absolute;width:100%;height:100%;top:",";transition:top 0.4s ease-in;"],e=>e.hide?"88px":"0px");class X extends r.a.PureComponent{constructor(e){super(e),s()(this,"debounceCheckForPoll",K()(this.props.checkForPollOnSlide,5e3)),s()(this,"onReceiveEvent",e=>{const t=e.data;switch(t.type){case m.X.OPEN_POLL:this.props.isReplay&&Object(G.Gb)("Poll Opened",{"Property Type":"Open Poll","User Id":this.props.userId,replay:!0});let e=Y.b.main.pollChangeEvents.get(t.id);!e.isAnswered&&e.replayId&&e.choices&&!this.props.bulkUpdate&&this.props.setOpenPoll(e);break;case m.X.CLOSE_POLL:this.closePoll()}}),s()(this,"processPollMessage",e=>{const t=this.props.poll,a=t&&(t.id==e.id||t.id==e.poll_id);switch(e.action){case"OPEN_POLL":this.handleOpenPoll(e);break;case"GET_POLL":a&&this.props.setGetPoll(e);break;case"RESPOND_POLL":a&&this.props.setUserPollResult(e);break;case"LEARNER_STREAK":t&&e.leader_board&&e.leader_board.length>0&&this.props.setPollLearnerStreakData(e.leader_board);break;case"SHARE_LEADER_BOARD":this.props.isEducator?this.props.setShowGlobalLeaderBoard(!0):(clearTimeout(this.classLeaderBoardMyRankTimeout),this.classLeaderBoardMyRankTimeout=setTimeout(()=>{this.getClassLeaderBoardMyRank()},500+Math.floor(500*Math.random())));break;case"CLASS_LEADERBOARD_MY_RANK":!this.props.isEducator&&e.leader_board&&(this.props.setGlobalLeaderBoard(e.leader_board,this.props.userId,e.my_stats),this.props.setShowGlobalLeaderBoard(!0));break;case"CLOSE_LEADER_BOARD":this.props.isEducator||this.props.setShowGlobalLeaderBoard(!1);break;case"CLOSE_POLL":a&&!this.props.isEducator&&(clearTimeout(this.pollLeaderBoardMyRankTimeout),this.pollLeaderBoardMyRankTimeout=setTimeout(()=>{this.getPollLeaderBoardMyRank(t.id)},500+Math.floor(500*Math.random())));break;case"POLL_LEADERBOARD_MY_RANK":a&&!this.props.isEducator&&(e.leader_board&&e.leader_board.length>0?this.props.setPollLeaderBoard(e.leader_board,e.my_stats.rank):this.closePoll());break;case"LEADER_BOARD":e.class_leader_board&&this.props.setGlobalLeaderBoard(e.class_leader_board);break;case"INCREASE_TIMER":e.poll_timer>0&&a&&this.props.setPollIncreaseTimer(e)}}),s()(this,"processEducatorConfigData",e=>{switch(e.config_type){case m.Sb.CONFIG_TYPE:e.config_value&&this.props.updateChatConfig({[m.Sb.CONFIG_TYPE]:JSON.parse(e.config_value)})}}),s()(this,"processEducatorConfigMessage",e=>{switch(e.action){case"GET_EDUCATOR_CONFIG":this.processEducatorConfigData(e.educator_config)}}),s()(this,"onSocketMessage",e=>{let t=JSON.parse(e);switch(t.type){case"DATA":let e=JSON.parse(t.text);switch(e.type){case"POLL":this.processPollMessage(JSON.parse(e.text));case"EDUCATOR_CONFIG":this.processEducatorConfigMessage(JSON.parse(e.text))}}}),s()(this,"closePoll",()=>{this.props.setClosePoll()}),s()(this,"onSubscription",()=>{this.getActivePoll()}),s()(this,"getActivePoll",()=>{this.props.socketManager.getActivePoll()}),s()(this,"getPollLeaderBoardMyRank",e=>{this.props.socketManager&&this.props.socketManager.getPollLeaderBoardMyRank(e)}),s()(this,"getClassLeaderBoardMyRank",()=>{this.props.socketManager&&this.props.socketManager.getClassLeaderBoardMyRank()}),s()(this,"hasClassLoaded",()=>this.props.isReplay?this.props.isReplayDataProcessed:this.props.isLiveDataProcessed||0===this.props.classState),this.state={},this.isSubscribedToSocketManager=!1}UNSAFE_componentWillReceiveProps(e){!e.isPdfEditor&&e.activeSlide!=this.props.activeSlide&&e.isEducator&&10===e.classState&&this.debounceCheckForPoll(e.activeSlide,e.classId,e.shouldPredictPoll,e.jwt)}componentDidUpdate(e){this.props.socketManager&&this.props.isSocketManagerInit&&!this.isSubscribedToSocketManager&&(this.isSubscribedToSocketManager=!0,this.props.socketManager.addMessageListener(this.onSocketMessage),this.props.socketManager.addSubscriptionListener(this.onSubscription))}componentWillUnmount(){this.props.socketManager&&(this.props.socketManager.removeMessageListener(this.onSocketMessage),this.props.socketManager.removeSubscriptionListener(this.onSubscription)),this.debounceCheckForPoll&&this.debounceCheckForPoll.cancel(),clearTimeout(this.classLeaderBoardMyRankTimeout),clearTimeout(this.pollLeaderBoardMyRankTimeout)}handleOpenPoll(e){this.props.poll&&e.id!=this.props.poll.id?this.props.updatePoll(e):this.props.setOpenPoll(e)}renderLearnerPoll(){if(!this.props.isEducator&&this.props.poll&&!this.props.showSplashScreen)return r.a.createElement(W,{socketManager:this.props.socketManager})}render(){return r.a.createElement(J,{hide:!this.props.isPollActive||this.props.isEducator||!this.hasClassLoaded()||this.props.showSplashScreen},this.renderLearnerPoll())}}const q={setOpenPoll:l.k,updatePoll:l.q,setGetPoll:l.f,setPollIncreaseTimer:l.l,setPollLeaderBoard:l.m,setUserPollResult:l.p,setPollLearnerStreakData:l.n,setClosePoll:l.c,setGlobalLeaderBoard:l.g,setShowGlobalLeaderBoard:l.o,checkForPollOnSlide:l.a,updateChatConfig:c.Lb};t.default=Object(n.c)(e=>({poll:e.getIn(["poll","poll"]),isPollActive:e.getIn(["poll","isPollActive"]),shouldPredictPoll:e.getIn(["app","shouldPredictPoll"]),isSocketManagerInit:e.getIn(["app","isSocketManagerInit"]),isEducator:e.getIn(["app","isEducator"]),isReplay:e.getIn(["app","isReplay"]),userId:e.getIn(["app","userId"]),bulkUpdate:e.getIn(["canvas","bulkUpdate"]),activeSlide:e.getIn(["canvas","activeSlide"]),jwt:e.getIn(["app","jwt"]),classId:e.getIn(["app","classId"]),showSplashScreen:e.getIn(["app","showSplashScreen"]),isReplayDataProcessed:e.getIn(["app","isReplayDataProcessed"]),isLiveDataProcessed:e.getIn(["app","isLiveDataProcessed"]),classState:e.getIn(["app","classState"]),isPdfEditor:e.getIn(["pdfEditor","isPdfEditor"])}),q,null,{forwardRef:!0})(X)}}]);
//# sourceMappingURL=poll.c2b7ea81ce74493b55ac.chunk.js.map