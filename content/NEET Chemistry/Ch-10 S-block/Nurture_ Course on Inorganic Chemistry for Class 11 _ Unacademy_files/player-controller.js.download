/*! UnacademyPlayer - v - 2019-06-26
* Copyright (c) 2019 Alok Maurya; Licensed  */
"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function getParameterByName(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);if(d&&d[2])return decodeURIComponent(d[2].replace(/\+/g," "))}function getClassNameForKey(a){return"unacademy_player_async_"+a}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),NOT_STARTED=0,PAUSED=1,ENDED=2,PLAYING=3,CONFIG={CDN_URL:"https://player.unacademy.link/lesson-raw/",UA_SCRIPT_URL:"https://d2my6fowp9ojw0.cloudfront.net/ua.js",UNACADEMY_ANALYTICS_ACCESS_TOKEN:"cvdfkljo89lkdjfkdf"},UserAgent=function(){function a(){_classCallCheck(this,a),this.browser=this._browserSniff(),this.ua={Android:/Android/gi.test(navigator.userAgent),iOS:/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),oldIE:"IE"===this.browser.name&&this.browser.version<=9}}return _createClass(a,[{key:"_browserSniff",value:function(){var a,b,c,d=navigator.userAgent,e=navigator.appName,f=""+parseFloat(navigator.appVersion),g=parseInt(navigator.appVersion,10);return navigator.appVersion.indexOf("Windows NT")!==-1&&navigator.appVersion.indexOf("rv:11")!==-1?(e="IE",f="11;"):(b=d.indexOf("MSIE"))!==-1?(e="IE",f=d.substring(b+5)):(b=d.indexOf("Chrome"))!==-1?(e="Chrome",f=d.substring(b+7)):(b=d.indexOf("Safari"))!==-1?(e="Safari",f=d.substring(b+7),(b=d.indexOf("Version"))!==-1&&(f=d.substring(b+8))):(b=d.indexOf("Firefox"))!==-1?(e="Firefox",f=d.substring(b+8)):(a=d.lastIndexOf(" ")+1)<(b=d.lastIndexOf("/"))&&(e=d.substring(a,b),f=d.substring(b+1),e.toLowerCase()==e.toUpperCase()&&(e=navigator.appName)),(c=f.indexOf(";"))!==-1&&(f=f.substring(0,c)),(c=f.indexOf(" "))!==-1&&(f=f.substring(0,c)),g=parseInt(""+f,10),isNaN(g)&&(f=""+parseFloat(navigator.appVersion),g=parseInt(navigator.appVersion,10)),{name:e,version:g,ios:/(iPad|iPhone|iPod)/g.test(navigator.platform),touch:"ontouchstart"in document.documentElement}}}]),a}(),UnPlayerController=function(){function a(){_classCallCheck(this,a),this.handlers={},this.init(),this.api=this,this.uaInitilized=!1}return _createClass(a,[{key:"init",value:function(){var a=this;window.addEventListener?addEventListener("message",function(b){return a.listener(b)},!1):attachEvent("onmessage",function(b){return a.listener(b)})}},{key:"unloadIframe",value:function(a){var b=document.getElementsByClassName(getClassNameForKey(a));if(b&&0!==b.length){b=b[0];var c=b.firstChild;c&&c.contentWindow.postMessage("beforeunload","*")}}},{key:"listener",value:function(a){if(a&&a.data){var b=a.data.uuid,c=(a.data.status||{},!0);if(a.data.event)switch(a.data.event){case"SEEK":c=!1;break;case"WATCHED":c=!1;break;case"STATE_CHANGE":c=!1}c&&this.sendAnalytics(a.data.event,a.data.status),b&&this.handlers.hasOwnProperty(b)&&this.handlers[b].onEvent(a.data.event,a.data.status,a)}}},{key:"initializeUA",value:function(){var a=this;if(!this.uaInitilized){if(window.ua)console.log("UA already loaded");else{var b=document.createElement("script");b.src=CONFIG.UA_SCRIPT_URL,b.onload=function(){},b.onerror=function(){a.uaInitilized=!1},document.body.appendChild(b),window.ua=window.ua||function(){(ua.q=ua.q||[]).push(arguments)},ua("create",CONFIG.UNACADEMY_ANALYTICS_ACCESS_TOKEN)}this.uaInitilized=!0}}},{key:"sendAnalytics",value:function(a,b){this.uaInitilized||this.initializeUA(),a&&ua("send","player_"+a,b)}},{key:"addHandler",value:function(a,b){var c=new Video(a);this.handlers[a]=c,b(c)}},{key:"getIframeElement",value:function(a){var b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,e=document.createElement("iframe"),f="";"undefined"!=typeof BETA&&BETA&&(f="_dev");var g="";return g=d?d+"&autoPlay="+b.toString()+"&debug="+c.toString():CONFIG.CDN_URL+"player"+f+"/v590/player-min.html?&autoPlay="+b.toString()+"&debug="+c.toString()+"&uuid="+a+"#"+a,e.src=g,e.border=0,e.style.height="100%",e.style.width="100%",e.style.maxHeight="100%",e.style.maxHeight="100%",e.style.border="none",e.setAttribute("allowFullScreen",""),e.setAttribute("scrolling","no"),e}},{key:"push",value:function(a){var b=this;for(var c in a)a.hasOwnProperty(c)&&!function(){b.addHandler(c,a[c]);var d=document.getElementsByClassName(getClassNameForKey(c));if(d.length>0){var e=d[0].hasAttribute("autoplay"),f=d[0].getAttribute("data-url"),g=d[0].firstChild;g&&d[0].removeChild(g),d[0].appendChild(b.getIframeElement(c,e,!1,f)),d[0].addEventListener("resize",function(a){setTimeout(function(){var a=d[0].offsetHeight>window.innerHeight?window.innerHeight:d[0].offsetHeight,b=d[0].offsetWidth>window.innerWidth?window.innerWidth:d[0].offsetWidth;d[0].childNodes[0].style.width=b+"px",d[0].childNodes[0].style.height=a+"px"},20)}),d[0].addEventListener("orientationchange",function(a){d[0].dispatchEvent(new Event("resize"))})}}()}},{key:"get",value:function(a){return this.handlers[a]}},{key:"getAll",value:function(){return this.handlers}},{key:"all",value:function(){var a=[];for(var b in this.handlers)this.handlers.hasOwnProperty(b)&&a.push(this.handlers[b]);return a}}]),a}(),FullScreenManagerInstance=null,FullScreenManager=function(){function a(){return _classCallCheck(this,a),FullScreenManagerInstance||(FullScreenManagerInstance=this),FullScreenManagerInstance}return _createClass(a,[{key:"addFullScreenStyle",value:function(){var a=document.createElement("style");a.type="text/css",a.id="fullScreenStyle",a.innerHTML=".full-screen { position: fixed !important; top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important;  height: 100% !important; z-index: 100000 !important; width: 100% !important; }",document.body.appendChild(a)}},{key:"fullScreenElement",value:function(a){for(document.getElementById("fullScreenStyle")||this.addFullScreenStyle();a;)this.applyClass("full-screen",a),a=a.parentElement}},{key:"removeFullScreen",value:function(a){for(;a;)this.applyClass("full-screen",a,!0),a=a.parentElement}},{key:"removeAllElementFullScreen",value:function(){for(var a=document.getElementsByClassName("full-screen"),b=a.length,c=0;c<b;c++)this.applyClass("full-screen",a[c],!0)}},{key:"applyClass",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];"string"==typeof b.valueOf()&&(b=document.getElementById(b)),b&&(c?b.className=b.className.replace(new RegExp("\\b"+a+"\\b","g"),""):b.className=b.className?b.className+" "+a:a)}}]),a}(),Video=function(){function a(b){_classCallCheck(this,a),this.uuid=b,this.lastStatus=void 0,this.callbacks={},this.readyCallback=void 0,this.origin=void 0,this.source=void 0,this.unbind=-99,this.userAgent=new UserAgent,this.fullScreenManager=new FullScreenManager,this.isFullScreen=!1}return _createClass(a,[{key:"ready",value:function(a){this.readyCallback=a}},{key:"changeFullScreen",value:function(){if(this.isFullScreen){var a=document.getElementsByClassName(getClassNameForKey(this.uuid));a.length>0&&(this.fullScreenManager.removeFullScreen(a[0]),a[0].dispatchEvent(new Event("resize")),this.isFullScreen=!1)}else{var b=document.getElementsByClassName(getClassNameForKey(this.uuid));b.length>0&&(this.fullScreenManager.fullScreenElement(b[0]),b[0].dispatchEvent(new Event("resize")),this.isFullScreen=!0)}}},{key:"onEvent",value:function(a,b,c){switch(this.lastStatus=b,this.origin=c.origin,this.source=c.source,a){case"EVENTS_LOADED":this.readyCallback&&this.readyCallback();break;case"FULLSCREEN_REQUEST":this.changeFullScreen()}if(this.callbacks.hasOwnProperty(a)&&this.callbacks[a]){console.log(a);var d=this.callbacks[a](this.lastStatus);d==this.unbind&&(this.callbacks[a]=void 0)}}},{key:"bind",value:function(a,b){this.callbacks[a]=b}},{key:"secondsWatched",value:function(){return this.lastStatus?this.lastStatus.TOTAL_RUN_TIME:0}},{key:"play",value:function(){this.origin&&this.source&&this.source.postMessage("play",this.origin)}},{key:"pause",value:function(){this.origin&&this.source&&this.source.postMessage("pause",this.origin)}},{key:"time",value:function(){return this.lastStatus?this.lastStatus.CURRENT_TIME:0}}]),a}();window._unq=new UnPlayerController,window.UnPlayer=window._unq;